<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Combined Regression • cornet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Combined Regression">
<meta property="og:description" content="cornet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cornet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">functions</a>
</li>
<li>
  <a href="../articles/vignette.html">vignette</a>
</li>
<li>
  <a href="../articles/article.html">article</a>
</li>
<li>
  <a href="../articles/simulation.html">simulation</a>
</li>
<li>
  <a href="../articles/application.html">application</a>
</li>
<li>
  <a href="../news/index.html">news</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rauschenberger/cornet">
    <span class="fas fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://cran.r-project.org/package=cornet">
    <span class="fas fa-download"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Combined Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rauschenberger/cornet/blob/master/vignettes/vignette.Rmd"><code>vignettes/vignette.Rmd</code></a></small>
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>It is considered bad statistical practice to dichotomise continuous outcomes, but some applications require predicted probabilities rather than predicted values. To obtain predicted values, we recommend to model the original continuous outcome with <em>linear regression</em>. To obtain predicted probabilities, we recommend not to model the artificial binary outcome with <em>logistic regression</em>, but to model the original continuous outcome and the artificial binary outcome with <em>combined regression</em>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the current release from <a href="https://CRAN.R-project.org/package=cornet">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"cornet"</span>)</pre></body></html></div>
<p>Or install the development version from <a href="https://github.com/rauschenberger/cornet">GitHub</a>:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">#install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"rauschenberger/cornet"</span>)</pre></body></html></div>
<p>Then load and attach the package:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cornet</span>)</pre></body></html></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>We simulate data for <span class="math inline">\(n\)</span> samples and <span class="math inline">\(p\)</span> features, in a high-dimensional setting (<span class="math inline">\(p \gg n\)</span>). The matrix <span class="math inline">\(\boldsymbol{X}\)</span> with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(p\)</span> columns represents the features, and the vector <span class="math inline">\(\boldsymbol{y}\)</span> of length <span class="math inline">\(n\)</span> represents the continuous outcome.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">100</span>; <span class="no">p</span> <span class="kw">&lt;-</span> <span class="fl">500</span>
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">n</span>*<span class="no">p</span>),<span class="kw">nrow</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">ncol</span><span class="kw">=</span><span class="no">p</span>)
<span class="no">beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">p</span>,<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">prob</span><span class="kw">=</span><span class="fl">0.05</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">mean</span><span class="kw">=</span><span class="no">X</span><span class="kw">%*%</span><span class="no">beta</span>)</pre></body></html></div>
<p>We use the function <code>cornet</code> for modelling the original continuous outcome and the artificial binary outcome. The argument <code>cutoff</code> splits the samples into two groups, those with an outcome less than or equal to the cutoff, and those with an outcome greater than the cutoff.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/cornet.html">cornet</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,<span class="kw">cutoff</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">X</span><span class="kw">=</span><span class="no">X</span>)
<span class="no">model</span></pre></body></html></div>
<p>The function <code>coef</code> returns the estimated coefficients. The first column is for the linear model (beta), and the second column is for the logistic model (gamma). The first row includes the estimated intercepts, and the other rows include the estimated slopes.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">coef</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">model</span>)</pre></body></html></div>
<p>The function <code>predict</code> returns fitted values for training data, or predicted values for testing data. The argument <code>newx</code> specifies the feature matrix. The output is a matrix with one column for each model.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">predict</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">model</span>,<span class="kw">newx</span><span class="kw">=</span><span class="no">X</span>)</pre></body></html></div>
<p>The function <code>cv.cornet</code> measures the predictive performance of combined regression by nested cross-validation, in comparison with logistic regression.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/cv.cornet.html">cv.cornet</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">y</span>,<span class="kw">cutoff</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">X</span><span class="kw">=</span><span class="no">X</span>)</pre></body></html></div>
<p>Here we observe that combined regression outperforms logistic regression (lower logistic deviance), and that logistic regression is only slightly better than the intercept-only model.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Rauschenberger A, and Glaab E (2021). “Predicting artificial binary outcomes from high-dimensional data”. <em>Manuscript in preparation.</em></p>
<!--
# Example

This is a confusing example because we would normally use ordinal regression!

Here we analyse the data from Pinho et al. (2016), available under the Gene Expression Omnibus ([GEO](https://www.ncbi.nlm.nih.gov/geo/)) accession number [GSE80599](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE80599). Our aim is to predict disease progression from gene expression.

The ordinal outcome $\boldsymbol{y}$ (MDS-UPDRS item 3.12, postural instability) ranges from $0$ (normal) to $4$ (severe), but Pinho et al. (2016) model the binary outcome $\boldsymbol{z}=\mathbb{I}(\boldsymbol{y} \geq 1)$, which indicates slow $(0)$ or rapid $(1)$ progression. 

## Data

We use the Bioconductor packages [`GEOquery`](https://doi.org/10.18129/B9.bioc.GEOquery) and [`Biobase`](https://doi.org/10.18129/B9.bioc.Biobase) for obtaining the data $(\approx 150$MB$)$:


```r
#install.packages("BiocManager")
#BiocManager::install(c("GEOquery","Biobase"))
data <- GEOquery::getGEO(GEO="GSE80599")[[1]]
pheno <- Biobase::pData(data)
y <- as.numeric(pheno$`updrs-mds3.12 score:ch1`)
age <- as.numeric(pheno$`age at examination (years):ch1`)
gender <- ifelse(pheno$`gender:ch1`=="Female",1,0)
X <- cbind(age,gender,t(Biobase::exprs(data)))
```

The vector $\boldsymbol{y}$ of length $n$ represents the outcome, and the matrix $\boldsymbol{X}$ with $n$ rows and $p$ columns represents the features. The first two columns include demographic variables (age, gender), and the other columns include the gene expression data.

## Filter

We test for marginal association between the ordinal outcome and the features. The smallest adjusted $p$-values is insignificant, and the $p$-value distribution is not right-skewed. There is probably not much signal in the data.


```r
pvalue <- apply(X,2,function(x) cor.test(x,y)$p.value)
min(p.adjust(pvalue))
hist(pvalue)
```

We filter the features to artificially increase the signal-to-noise ratio. This filtering leads to *bias* and *overfitting*, and must not be done in practical applications!


```r
cor <- abs(cor(y,X,method="spearman"))
X <- X[,cor>0.3] # forbidden!
```

Pinho R, Guedes LC, Soreq L, Lobo PP, Mestre T, Coelho M, et al. (2016). "Gene Expression Differences in Peripheral Blood of Parkinson’s Disease Patients with Distinct Progression Profiles". *PLoS ONE* 11(6):e0157852. [doi:10.1371/journal.pone.0157852](https://doi.org/10.1371/journal.pone.0157852)

# Cognitive impairment

Rani et al. (2017): GSE97644


```r
#install.packages("BiocManager")
#BiocManager::install("GEOquery")
files <- GEOquery::getGEOSuppFiles("GSE97644")
pheno <- read.csv(textConnection(readLines(rownames(files)[1])))
y <- pheno$MOCA.Score
gender <- ifelse(pheno$Gender=="Female",1,0)
age <- pheno$Age
geno <- t(read.csv(textConnection(readLines(rownames(files)[2])),row.names=1))
X <- cbind(gender,age,geno)
```


```r
net <- cornet::cornet(y=y,cutoff=25,X=X)
set.seed(1)
cornet:::cv.cornet(y=y,cutoff=25,X=X)
```

# Other


```r
files <- GEOquery::getGEOSuppFiles("GSE95640")
X <- t(read.csv(textConnection(readLines(rownames(files)[1])),row.names=1))
y <- GEOquery::getGEO(GEO="GSE95640")[[1]] # no numeric outcome
```


```r
data <- GEOquery::getGEO(GEO="GSE109597")[[1]]
y <- as.numeric(Biobase::pData(data)$"bmi:ch1")
X <- t(Biobase::exprs(data))
cornet:::cv.cornet(y=y,cutoff=25,X=X,alpha=0)
```

Rani A, O'Shea A, Ianov L, Cohen RA et al. (2017). "miRNA in Circulating Microvesicles as Biomarkers for Age-Related Cognitive Decline". Frontiers in Aging Neuroscience 9:323. [doi:10.3389/fnagi.2017.00323](https://doi.org/10.3389/fnagi.2017.00323)
-->
<!--
$(\hat{\boldsymbol{\beta}})$
$(\hat{\boldsymbol{\gamma}})$
$(\hat{\beta}_0$ and $\hat{\gamma}_0)$
$(\hat{\beta}_j$ and $\hat{\gamma}_j$ $\forall j \in \{1,\ldots,p\})$

### Example ###

```r
#install.packages("BiocManager")
#BiocManager::install("mixOmics")
set.seed(1)
data(liver.toxicity,package="mixOmics")
X <- as.matrix(liver.toxicity$gene)
Y <- liver.toxicity$clinic
cornet <- cornet::cornet(y=Y$BUN.mg.dL.,cutoff=15,X=X)
cornet:::cv.cornet(y=Y$BUN.mg.dL.,cutoff=15,X=X)

loss <- list()
for(i in seq_along(Y)){
  loss[[i]] <- cornet:::cv.cornet(y=Y[[i]],cutoff=median(Y[[i]]),alpha=0,X=X)
}
sapply(loss,function(x) x$deviance)
```
-->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rauschenberger.github.io">Armin Rauschenberger</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
